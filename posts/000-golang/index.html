<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.55.6" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>[Golang系列]-包依赖管理工具Govendor | 凡夫俗子的博客</title>
    <meta property="og:title" content="[Golang系列]-包依赖管理工具Govendor - 凡夫俗子的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content="2019-07-15T16:46:25&#43;08:00">
        
        
    <meta property="article:modified_time" content="2019-07-15T16:46:25&#43;08:00">
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,kubernetes,项目管理,python">
    <meta name="description" content="[Golang系列]-包依赖管理工具Govendor">
        
    <meta name="author" content="凡夫俗子">
    <meta property="og:url" content="http://gitzh2017.github.io/posts/000-golang/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="/css/normalize.css">
    
        <link rel="stylesheet" href="/css/prism.css">
    
    <link rel="stylesheet" href="/css/style.css">
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    


    
    
</head>

<body>
<header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="http://gitzh2017.github.io/">
                        凡夫俗子的博客
                    </a>
                
                <p class="description">专注于Kubernetes、Python、Go语言(golang)、Linux、项目管理、软件架构</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="" href="http://gitzh2017.github.io/">首页</a>
                    
                    <a  href="http://gitzh2017.github.io/archives/" title="归档">归档</a>
                    
                    <a  href="http://gitzh2017.github.io/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>


<div id="body">
    <div class="container">
        <div class="col-group">

            <div class="col-8" id="main">
                <div class="res-cons">
                    <article class="post">
                        <header>
                            <h1 class="post-title">[Golang系列]-包依赖管理工具Govendor</h1>
                        </header>
                        <date class="post-meta meta-date">
                            2019年7月15日
                        </date>
                        
                        
                        
                        <div class="clear">
                            <div class="toc-article">
                                <div class="toc-title">文章目录</div>
                                <nav id="TableOfContents">
<ul>
<li><a href="#vendor-特性">vendor 特性</a></li>
<li><a href="#govendor">govendor</a>
<ul>
<li><a href="#govendor-简介">govendor 简介</a></li>
<li><a href="#govendor-使用">govendor 使用</a>
<ul>
<li><a href="#安装">安装</a></li>
<li><a href="#初始化">初始化</a></li>
<li><a href="#常用命令">常用命令</a></li>
</ul></li>
<li><a href="#govendor-子命令">govendor 子命令</a></li>
<li><a href="#govendor-状态参数">govendor 状态参数</a></li>
</ul></li>
<li><a href="#go-modules">Go modules</a></li>
</ul>
</nav>
                            </div>
                        </div>
                        
                        <div class="post-content">
                            <p><code>govendor</code> 是一个基于<code>vendor</code>机制实现的 Go 包依赖管理命令行工具。与原生 vendor 无侵入性融合，也支持从其他依赖管理工具迁移，可以很方便的实现同一个包在不同项目中不同版本、以及无相互侵入的开发和管理。</p>

<h1 id="vendor-特性">vendor 特性</h1>

<p>最开始的时候，Go 并没有提供较为妥当的包管理工具。从 1.5 版本开始提供了 vendor 特性，但需要手动设置环境变量 <code>GO15VENDOREXPERIMENT=1</code>。</p>

<p>在执行 <code>go build</code> 或 <code>go run</code> 命令时，会按照以下顺序去查找包：</p>

<ul>
<li>当前包下的 vendor 目录</li>
<li>向上级目录查找，直到找到 src 下的 vendor 目录</li>
<li>在 GOROOT 目录下查找</li>
<li>在 GOPATH 下面查找依赖包</li>
</ul>

<p>在发布 1.6 版本时，该环境变量的值已经默认设置为 1 了，该值可以使用 <code>go env</code> 命令查看。</p>

<p>在发布 1.7 版本时，已去掉该环境变量，默认开启 <code>vendor</code> 特性。</p>

<h1 id="govendor">govendor</h1>

<h2 id="govendor-简介">govendor 简介</h2>

<p><a href="https://github.com/kardianos/govendor">govendor</a> 是一个基于 <code>vendor</code> 目录机制的包管理工具。</p>

<ul>
<li>支持从项目源码中分析出依赖的包，并从 <code>$GOPATH</code> 复制到项目的 <code>vendor</code> 目录下</li>
<li>支持包的指定版本，并用 <code>vendor/vendor.json</code> 进行包和版本管理，这点与 PHP 的 <code>Composer</code> 类似</li>
<li>支持用 <code>govendor add/update</code> 命令从 <code>$GOPATH</code> 中复制依赖包</li>
<li>如果忽略了 <code>vendor/*/</code> 文件，可用 <code>govendor sync</code> 恢复依赖包</li>
<li>可直接用 <code>govendor fetch</code> 添加或更新依赖包</li>
<li>可用 <code>govendor migrate</code> 从其他 <code>vendor</code> 包管理工具中一键迁移到 <code>govendor</code></li>
<li>支持 Linux，macOS，Windows，甚至现有所有操作系统</li>
<li>支持 Git、Hg、SVN，BZR（必须指定一个路径）</li>
</ul>

<h2 id="govendor-使用">govendor 使用</h2>

<p>要求： - 项目必须在 <code>$GOPATH/src</code> 目录下 - 如果 Go 版本为 1.5，则必须手动设置环境变量 <code>set GO15VENDOREXPERIMENT=1</code></p>

<h3 id="安装">安装</h3>

<pre><code class="language-sh">go get -u github.com/kardianos/govendor
</code></pre>

<p>为了方便快捷使用 <code>govendor</code>，建议将 <code>$GOPATH/bin</code> 添加到 PATH 中。Linux/macOS 如下设置：</p>

<pre><code class="language-sh">export PATH=&quot;$GOPATH/bin:$PATH&quot;
</code></pre>

<h3 id="初始化">初始化</h3>

<p>在项目根目录下执行以下命令进行 <code>vendor</code> 初始化：</p>

<pre><code class="language-sh">govendor init
</code></pre>

<p>项目根目录下即会自动生成 <code>vendor</code> 目录和 <code>vendor.json</code> 文件。此时 <code>vendor.json</code> 文件内容为：</p>

<pre><code class="language-json">{
	&quot;comment&quot;: &quot;&quot;,
	&quot;ignore&quot;: &quot;test&quot;,
	&quot;package&quot;: [],
	&quot;rootPath&quot;: &quot;govendor-example&quot;
}
</code></pre>

<h3 id="常用命令">常用命令</h3>

<ul>
<li><p>将已被引用且在 <code>$GOPATH</code> 下的所有包复制到 <code>vendor</code> 目录</p>

<pre><code>govendor add +external
</code></pre></li>

<li><p>仅从 <code>$GOPATH</code> 中复制指定包</p>

<pre><code>govendor add gopkg.in/yaml.v2
</code></pre></li>

<li><p>列出代码中所有被引用到的包及其状态</p>

<pre><code>govendor list
e  github.com/gin-contrib/sse
e  github.com/gin-gonic/gin
e  github.com/gin-gonic/gin/binding
e  github.com/gin-gonic/gin/internal/json
e  github.com/gin-gonic/gin/render
e  github.com/golang/protobuf/proto
e  github.com/mattn/go-isatty
e  github.com/ugorji/go/codec
e  gopkg.in/go-playground/validator.v8
e  gopkg.in/yaml.v2
pl  govendor-example
m github.com/json-iterator/go
m golang.org/x/sys/unix
</code></pre></li>

<li><p>列出一个包被哪些包引用</p>

<pre><code>govendor list -v fmt
s  fmt
├──  e  github.com/gin-contrib/sse
├──  e  github.com/gin-gonic/gin
├──  e  github.com/gin-gonic/gin/render
├──  e  github.com/golang/protobuf/proto
├──  e  github.com/ugorji/go/codec
├──  e  gopkg.in/go-playground/validator.v8
├──  e  gopkg.in/yaml.v2
└── pl  govendor-example
</code></pre></li>

<li><p>从远程仓库添加或更新某个包(<strong>不会</strong>在 <code>$GOPATH</code> 也存一份)</p>

<pre><code>govendor fetch golang.org/x/net/context
</code></pre></li>

<li><p>安装指定版本的包</p></li>
</ul>

<pre><code class="language-sh">govendor fetch golang.org/x/net/context@a4bbce9fcae005b22ae5443f6af064d80a6f5a55
govendor fetch golang.org/x/net/context@v1   # Get latest v1.*.* tag or branch.
govendor fetch golang.org/x/net/context@=v1  # Get the tag or branch named &quot;v1&quot;.
</code></pre>

<ul>
<li><p>只格式化项目自身代码(<code>vendor</code> 目录下的不变动)</p>

<pre><code>govendor fmt +local
</code></pre></li>

<li><p>只构建编译项目内部的包</p>

<pre><code>govendor install +local
</code></pre></li>

<li><p>只测试项目内部的测试案例</p>

<pre><code>govendor test +local
</code></pre></li>

<li><p>构建所有 <code>vendor</code> 包</p>

<pre><code>govendor install +vendor,^program
</code></pre></li>

<li><p>拉取所有依赖的包到 <code>vendor</code> 目录(包括 <code>$GOPATH</code> 存在或不存在的包)</p>

<pre><code>govendor fetch +out
</code></pre></li>

<li><p>包已在 <code>vendor</code> 目录，但想从 <code>$GOPATH</code> 更新</p>

<pre><code>govendor update +vendor
</code></pre></li>

<li><p>已修改了 <code>$GOPATH</code> 里的某个包，现在想将已修改且未提交的包更新到 <code>vendor</code></p>

<pre><code>govendor update -uncommitted &lt;updated-package-import-path&gt;
</code></pre></li>

<li><p>Fork 了某个包，但尚未合并，该如何引用到最新的代码包</p>

<pre><code>govendor fetch github.com/normal/pkg::github.com/myfork/pkg
</code></pre></li>
</ul>

<p>此时将从 <code>myfork</code> 拉取代码，而不是 <code>normal</code>。</p>

<ul>
<li><p><code>vendor.json</code> 中记录了依赖包信息，该如何拉取更新</p>

<pre><code>govendor sync
</code></pre></li>
</ul>

<h2 id="govendor-子命令">govendor 子命令</h2>

<p>各子命令详细用法可通过 <code>govendor COMMAND -h</code> 或阅读 <code>github.com/kardianos/govendor/context</code> 查看源码包如何实现的。</p>

<table>
<thead>
<tr>
<th>子命令</th>
<th>功能</th>
</tr>
</thead>

<tbody>
<tr>
<td>init</td>
<td>创建 <code>vendor</code> 目录和 <code>vendor.json</code> 文件</td>
</tr>

<tr>
<td>list</td>
<td>列出&amp;过滤依赖包及其状态</td>
</tr>

<tr>
<td>add</td>
<td>从 <code>$GOPATH</code> 复制包到项目 <code>vendor</code> 目录</td>
</tr>

<tr>
<td>update</td>
<td>从 <code>$GOPATH</code> 更新依赖包到项目 <code>vendor</code> 目录</td>
</tr>

<tr>
<td>remove</td>
<td>从 <code>vendor</code> 目录移除依赖的包</td>
</tr>

<tr>
<td>status</td>
<td>列出所有缺失、过期和修改过的包</td>
</tr>

<tr>
<td>fetch</td>
<td>从远程仓库添加或更新包到项目 <code>vendor</code> 目录(不会存储到 <code>$GOPATH</code>)</td>
</tr>

<tr>
<td>sync</td>
<td>根据 <code>vendor.json</code> 拉取相匹配的包到 <code>vendor</code> 目录</td>
</tr>

<tr>
<td>migrate</td>
<td>从其他基于 <code>vendor</code> 实现的包管理工具中一键迁移</td>
</tr>

<tr>
<td>get</td>
<td>与 <code>go get</code> 类似，将包下载到 <code>$GOPATH</code>，再将依赖包复制到 <code>vendor</code> 目录</td>
</tr>

<tr>
<td>license</td>
<td>列出所有依赖包的 LICENSE</td>
</tr>

<tr>
<td>shell</td>
<td>可一次性运行多个 <code>govendor</code> 命令</td>
</tr>
</tbody>
</table>

<h2 id="govendor-状态参数">govendor 状态参数</h2>

<table>
<thead>
<tr>
<th>状态</th>
<th>缩写</th>
<th>含义</th>
</tr>
</thead>

<tbody>
<tr>
<td>+local</td>
<td>l</td>
<td>本地包，即项目内部编写的包</td>
</tr>

<tr>
<td>+external</td>
<td>e</td>
<td>外部包，即在 <code>GOPATH</code> 中、却不在项目 <code>vendor</code> 目录</td>
</tr>

<tr>
<td>+vendor</td>
<td>v</td>
<td>已在 <code>vendor</code> 目录下的包</td>
</tr>

<tr>
<td>+std</td>
<td>s</td>
<td>标准库里的包</td>
</tr>

<tr>
<td>+excluded</td>
<td>x</td>
<td>明确被排除的外部包</td>
</tr>

<tr>
<td>+unused</td>
<td>u</td>
<td>未使用的包，即在 <code>vendor</code> 目录下，但项目中并未引用到</td>
</tr>

<tr>
<td>+missing</td>
<td>m</td>
<td>被引用了但却找不到的包</td>
</tr>

<tr>
<td>+program</td>
<td>p</td>
<td>主程序包，即可被编译为执行文件的包</td>
</tr>

<tr>
<td>+outside</td>
<td></td>
<td>相当于状态为 <code>+external +missing</code></td>
</tr>

<tr>
<td>+all</td>
<td></td>
<td>所有包</td>
</tr>
</tbody>
</table>

<p>支持状态参数的子命令有：<code>list</code>、<code>add</code>、<code>update</code>、<code>remove</code>、<code>fetch</code></p>

<h1 id="go-modules">Go modules</h1>

<p>普大喜奔的是，从 Go 1.11 版本开始，官方已内置了更为强大的 <a href="https://golang.org/cmd/go/#hdr-Modules__module_versions__and_more">Go modules</a> 来一统多年来 Go 包依赖管理混乱的局面(Go 官方之前推出的 <a href="https://github.com/golang/dep">dep</a> 工具也几乎胎死腹中)，并且将在 1.13 版本中正式默认开启。</p>

<p>目前已受到社区的看好和强烈推荐，建议新项目采用 Go modules。</p>
                        </div>

                        


                        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/12-golang/">[Golang系列]-Go基础语法之错误处理</a></li>
        
        <li><a href="/posts/00-django/">[Django系列]-Django初识</a></li>
        
        <li><a href="/02-elasticsearch/">02 Elasticsearch</a></li>
        
        <li><a href="/01-elasticsearch/">[Elasticsearch系列]-Elasticsearch Operator快速部署Elasticsearch集群</a></li>
        
        <li><a href="/00-elasticsearch/">[Elasticsearch系列]-概述</a></li>
        
    </ul>
</div>


                        <div class="post-meta meta-tags">
                            
                            没有标签
                            
                        </div>
                    </article>
                    
    

    
    
                </div>
            </div>
            <div id="secondary">
    <section class="widget">
        <form id="search" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="http://gitzh2017.github.io/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="http://gitzh2017.github.io/posts/000-golang/" title="[Golang系列]-包依赖管理工具Govendor">[Golang系列]-包依赖管理工具Govendor</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/12-golang/" title="[Golang系列]-Go基础语法之错误处理">[Golang系列]-Go基础语法之错误处理</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/00-django/" title="[Django系列]-Django初识">[Django系列]-Django初识</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/11-golang/" title="[Golang系列]-Go基础语法之指针">[Golang系列]-Go基础语法之指针</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/10-golang/" title="[Golang系列]-Go基础语法之map">[Golang系列]-Go基础语法之map</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/09-golang/" title="[Golang系列]-Go基础语法之切片">[Golang系列]-Go基础语法之切片</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/08-golang/" title="[Golang系列]-Go基础语法之数组">[Golang系列]-Go基础语法之数组</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/07-golang/" title="[Golang系列]-Go基础语法之函数">[Golang系列]-Go基础语法之函数</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/06-golang/" title="[Golang系列]-Go基础语法之流程控制">[Golang系列]-Go基础语法之流程控制</a>
    </li>
    
    <li>
        <a href="http://gitzh2017.github.io/posts/05-golang/" title="[Golang系列]-Go基础语法之运算符">[Golang系列]-Go基础语法之运算符</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="http://gitzh2017.github.io/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
        </div>
    </div>
</div>
<footer id="footer">
    <div class="container">
        &copy; 2019 <a href="http://gitzh2017.github.io/">凡夫俗子的博客 By 凡夫俗子</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/rujews/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    <script type="text/javascript">
    
    (function(){
        $("pre code").parent().addClass("line-numbers")
    }())

    window.MathJax = {
        tex2jax: {
            inlineMath: [ ['$','$'] ],
            processEscapes: true
        }
    };
    </script>
    <script type="text/javascript" src="/js/prism.js" async="true"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src="/js/totop.js?v=0.0.0" async=""></script>






</body>
</html>
